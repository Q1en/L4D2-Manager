# L4D2 服务器与插件管理器

## 简介

这是一款为 Windows 平台上的求生之路2（Left 4 Dead 2）专用服务器量身打造的管理工具。它使用现代化、稳定可靠的 PowerShell 语言编写，旨在终结手动管理 SourceMod 平台及服务器插件时容易出错、难以维护的困境。

通过本工具，你可以极大地简化插件的安装、移除和日常管理流程。

## 主要功能

  * **一键安装/更新 SourceMod 与 MetaMod**
    你只需将从官网下载的 `.zip` 安装包放入指定文件夹，脚本即可自动识别最新版本并完成解压、安装以及关键引导文件（`metamod.vdf`）的创建。

  * **模块化的插件管理**
    每个插件（及其所有相关文件，如`.smx`, `.cfg`, `.txt`等）都存放于一个独立的文件夹中，管理思路清晰，插件之间互不干扰。

  * **可逆的安装与移除**
    安装插件时，脚本会自动记录该插件包含的所有文件清单。当你选择移除插件时，脚本会根据这份清单，精确地将服务器中对应的文件一一安全地移回其原始位置，确保服务器文件纯净。

  * **强大的兼容性**
    得益于 PowerShell 的原生 Unicode 支持，本工具可以完美处理包含任何语言（中文、日文等）及特殊字符（`()` `!` `&` 等）的插件文件夹名，彻底告别了因命名问题导致的安装失败。

  * **清晰的可视化菜单**
    提供了一个可视化菜单来选择插件，管理效率高，对新手服主非常友好。

## 使用方法

### 第一步：准备工作

1.  **系统要求：** 一台运行 Windows 10 或更高版本的电脑。

2.  **服务器文件：** 你已经通过 SteamCMD 或其他方式下载好了求生之路2的服务器文件。

3.  **创建目录结构：** 在你喜欢的位置（例如桌面）创建一个主管理文件夹，并按以下结构组织文件：

    ```
    L4D2_Manager/
    │
    ├── L4D2_Manager.ps1        (本脚本)
    │
    ├── Available_Plugins/      (用于存放所有可用插件)
    │
    └── Installed_Receipts/     (用于存放已安装插件的回执文件)
    │
    └── SourceMod_Installers/   (用于存放 SourceMod 和 MetaMod 的 .zip 安装包)
    ```

      * 第一次启动时会自动创建 `Available_Plugins`、 `Installed_Receipts` 和 `SourceMod_Installers` 这三个空文件夹。

### 第二步：配置脚本

1.  用记事本、VS Code 或任何文本编辑器打开 `L4D2_Manager.ps1` 脚本文件。
2.  找到脚本最上方的**用户配置区**：
    ```powershell
    # --- 用户配置区 (请务必修改!) ---
    $ServerRoot = "D:\L4D2Server"
    ```
3.  将 `"D:\L4D2Server"` 修改为你自己电脑上 L4D2 服务器的**根目录路径**（即包含 `srcds.exe` 的那个文件夹的路径）。
4.  保存文件。

### 第三步：运行脚本

#### A. 设置执行策略（首次使用，仅需操作一次）

出于安全考虑，Windows 默认禁止直接运行 PowerShell 脚本。你需要为当前用户开启权限。

1.  在 Windows 的开始菜单或搜索栏中输入 `PowerShell`。
2.  右键点击“**Windows PowerShell**”，选择“**以管理员身份运行**”。
3.  在打开的蓝色管理员窗口中，复制并粘贴以下命令，然后按回车：
    ```powershell
    Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
    ```
4.  系统会询问你是否要更改执行策略，输入 `A` 然后按回车表示“全是”。
5.  完成后，你可以关闭这个管理员窗口。此操作在你的电脑上只需进行一次。

#### B. 启动管理器

1.  进入你创建的 `L4D2_Manager` 文件夹。
2.  在文件夹的空白处，按住键盘上的 `Shift` 键，同时单击鼠标右键。
3.  在弹出的菜单中，选择“**在此处打开 PowerShell 窗口**”。
4.  在打开的 PowerShell 窗口中，输入以下命令并按回车，即可启动脚本：
    ```powershell
    .\L4D2_Manager.ps1
    ```

### 第四步：使用菜单

脚本启动后，你会看到一个清晰的菜单。根据屏幕上的提示输入对应的数字即可执行相应操作：

  * **操作 [1] 安装/更新 SourceMod 和 MetaMod：**

      * 将从官网下载的 `sourcemod-xxx.zip` 和 `mmsource-xxx.zip` 文件直接放入 `SourceMod_Installers` 文件夹内，然后执行此选项。

  * **操作 [2] 安装插件：**

      * 将你要安装的整个插件文件夹（示例： `[自选]-管理员菜单\left4dead2\*` ）放入 `Available_Plugins` 文件夹内，然后执行此选项并选择对应的ID。

  * **操作 [3] 移除插件：**

      * 脚本会列出所有已安装的插件。选择你想移除的插件ID即可，脚本会自动将其文件安全地移回 `Available_Plugins` 文件夹。
